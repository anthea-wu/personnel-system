# Leave Application Component Test Cases

## 🧪 **Component Test 案例規劃**

### 📋 **測試分類與案例**

#### **1. 基本渲染測試**
- [ ] 頁面成功載入並顯示標題「請假申請」
- [ ] 所有必要的表單欄位都正確渲染（姓名、假別、時間類型、日期、原因）
- [ ] 送出按鈕正確顯示

#### **2. 時間類型切換測試** 
- [ ] 預設選擇「全天」模式
- [ ] 切換到「指定時間」模式時，時間選擇器正確顯示
- [ ] 切換回「全天」模式時，時間選擇器正確隱藏
- [ ] 切換到「指定時間」模式時，結束日期自動同步開始日期

#### **3. 表單驗證測試（空白提交）**
- [ ] 全部欄位空白提交時，顯示對應的錯誤訊息
- [ ] 只填寫姓名提交時，其他欄位顯示錯誤訊息
- [x] 指定時間模式下不選擇任何時間時，同時顯示「請選擇開始時間」和「請選擇結束時間」錯誤

#### **4. 指定時間模式的詳細驗證測試**
- [ ] 只選擇開始小時不選分鐘時，顯示開始時間錯誤
- [ ] 只選擇結束小時不選分鐘時，顯示結束時間錯誤
- [ ] 結束時間早於開始時間時，顯示時間間隔錯誤
- [ ] 時間間隔少於30分鐘時，顯示時間間隔錯誤

#### **5. 表單互動測試**
- [ ] 輸入姓名後錯誤訊息消失
- [ ] 選擇假別後錯誤訊息消失
- [ ] 選擇日期後錯誤訊息消失
- [ ] 選擇完整時間後錯誤訊息消失

#### **6. 日期邏輯測試**
- [ ] 全天模式下選擇開始日期
- [ ] 全天模式下結束日期不能早於開始日期
- [ ] 指定時間模式下結束日期被禁用且自動同步

#### **7. 時間選擇器邏輯測試**
- [ ] 時間選擇器只顯示 8-18 點
- [ ] 分鐘選擇器只有 00 和 30 選項
- [ ] 開始時間30分時，同一小時的結束時間被禁用
- [ ] 結束小時選項根據開始時間正確禁用

#### **8. 表單提交測試**
- [ ] 有效表單提交時顯示載入狀態
- [ ] 模擬 API 成功回應時顯示成功訊息
- [ ] 模擬 API 失敗回應時顯示錯誤訊息
- [ ] 成功提交後表單重置

#### **9. 錯誤顯示測試**
- [ ] 錯誤訊息顯示在正確的欄位下方
- [ ] 錯誤狀態時欄位邊框變紅色
- [ ] 時間欄位錯誤訊息顯示在時間選擇器下方

#### **10. 無障礙測試**
- [ ] 所有表單欄位都有正確的 label
- [ ] 錯誤訊息與對應欄位正確關聯（aria-describedby）
- [ ] 必填欄位有 required 屬性

### 🎯 **重點測試目標**

這個測試的主要目的是驗證：
1. **你提到的問題**：指定時間模式下時間欄位沒有錯誤訊息
2. **表單驗證邏輯**：確保 Zod + React Hook Form 的整合正確運作
3. **使用者體驗**：確保錯誤訊息在正確的位置顯示

### 🔧 **測試工具規劃**

- **Vitest** - 測試執行器
- **React Testing Library** - 組件渲染和互動
- **jsdom** - DOM 環境模擬
- **MSW (Mock Service Worker)** - API 模擬（表單提交）

### 📝 **測試實現優先級**

#### **高優先級（核心功能）**
- 基本渲染測試
- 時間類型切換測試
- 表單驗證測試（空白提交）
- 指定時間模式的詳細驗證測試

#### **中優先級（使用者體驗）**
- 表單互動測試
- 錯誤顯示測試
- 日期邏輯測試

#### **低優先級（進階功能）**
- 時間選擇器邏輯測試
- 表單提交測試
- 無障礙測試

### 🚨 **已知問題待驗證**

1. **時間欄位錯誤訊息問題**：
   - 當使用者在指定時間模式下沒有選擇時間時
   - 時間下拉選單只變紅色，但沒有顯示錯誤訊息文字
   - 應該像其他欄位一樣在下方顯示具體的錯誤說明

2. **可能的根本原因**：
   - Zod schema 驗證邏輯可能有問題
   - React Hook Form 錯誤狀態綁定可能不正確
   - 錯誤訊息顯示組件可能有條件判斷問題